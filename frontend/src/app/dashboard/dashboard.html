@if (eversportsData()) {
<div class="px-4 py-8 max-w-7xl mx-auto min-h-screen">
  <header class="mb-12 text-center animate-in fade-in slide-in-from-top-4 duration-1000">
    <h1 class="text-5xl md:text-6xl font-extrabold mb-4 tracking-tight">
      <span
        class="bg-gradient-to-r from-neon-cyan via-neon-purple to-neon-pink bg-clip-text text-transparent drop-shadow-sm">
        Padel Slot Finder
      </span>
    </h1>
  </header>

  <!-- Compact Toolbar -->
  <div
    class="mb-8 glass p-2 px-4 rounded-2xl border border-white/5 flex flex-col md:flex-row items-center justify-between gap-4">
    <!-- Prime Info Mini -->
    <div class="flex items-center gap-4 text-[10px] font-bold tracking-widest uppercase">
      <div class="flex items-center gap-2 text-solar-gold mr-2">
        <fa-icon [icon]="faBolt" size="xs"></fa-icon>
        <span>Prime Slots:</span>
      </div>
      <div class="flex items-center gap-2">
        <span class="w-1.5 h-1.5 rounded-full bg-neon-cyan animate-pulse"></span>
        <span class="text-gray-500">Wk:</span>
        <span class="text-gray-200">15-19:00</span>
      </div>
      <div class="flex items-center gap-2">
        <span class="w-1.5 h-1.5 rounded-full bg-neon-purple"></span>
        <span class="text-gray-500">We:</span>
        <span class="text-gray-200">08-18:00</span>
      </div>
    </div>

    <!-- Filters Mini -->
    <div class="flex items-center gap-3 w-full md:w-auto">
      <div class="flex items-center gap-2 text-gray-500 text-[9px] font-black uppercase tracking-widest mr-1">
        <fa-icon [icon]="faFilter"></fa-icon>
        <span>Filter:</span>
      </div>
      <div class="flex gap-2 flex-1 md:flex-none">
        <button (click)="setGoldenOnly(!showGoldenOnly())"
          class="flex-1 md:flex-none px-4 py-2 rounded-xl text-[10px] font-bold transition-all duration-300 flex items-center justify-center gap-2 border border-white/5"
          [class.bg-neon-cyan/20]="showGoldenOnly()" [class.text-neon-cyan]="showGoldenOnly()"
          [class.border-neon-cyan/40]="showGoldenOnly()" [class.glass-dark]="!showGoldenOnly()"
          [class.text-gray-400]="!showGoldenOnly()">
          <fa-icon [icon]="faStar" size="xs"></fa-icon>
          1h Pro
        </button>
        <button (click)="setJackpotOnly(!showJackpotOnly())"
          class="flex-1 md:flex-none px-4 py-2 rounded-xl text-[10px] font-bold transition-all duration-300 flex items-center justify-center gap-2 border border-white/5"
          [class.bg-solar-gold/20]="showJackpotOnly()" [class.text-solar-gold]="showJackpotOnly()"
          [class.border-solar-gold/40]="showJackpotOnly()" [class.glass-dark]="!showJackpotOnly()"
          [class.text-gray-400]="!showJackpotOnly()">
          <fa-icon [icon]="faFire" size="xs"></fa-icon>
          2h Prime
        </button>
      </div>
    </div>
  </div>

  <!-- Date Selector Matrix -->
  <div class="mb-4 relative">
    <div #dateContainer class="overflow-x-auto pb-4 date-scrollbar scroll-smooth flex items-center gap-2">
      @for (date of dates; track date) {
      <button (click)="setSelectedDate(date)"
        class="flex-shrink-0 min-w-[80px] px-4 py-3 rounded-2xl transition-all duration-300 flex flex-col items-center gap-1 border relative overflow-hidden active:scale-95"
        [class.glass-dark]="selectedDate() !== date" [class.bg-neon-cyan/20]="selectedDate() === date"
        [class.border-neon-cyan/50]="selectedDate() === date" [class.border-white/5]="selectedDate() !== date">
        <!-- Availability Indicators -->
        <div class="absolute top-2 right-2 flex gap-1">
          @if (dateStats()[date]?.hasGolden) {
          <span class="w-1 h-1 rounded-full bg-neon-cyan shadow-[0_0_5px_rgba(0,242,255,0.8)]"></span>
          }
          @if (dateStats()[date]?.hasJackpot) {
          <span class="w-1 h-1 rounded-full bg-solar-gold shadow-[0_0_5px_rgba(255,195,0,0.8)]"></span>
          }
        </div>

        <span class="text-[10px] uppercase tracking-tighter" [class.text-neon-cyan]="selectedDate() === date"
          [class.text-gray-500]="selectedDate() !== date">
          {{ getShortDate(date).split(' ')[0] }}
        </span>
        <span class="text-sm font-bold" [class.text-white]="selectedDate() === date"
          [class.text-gray-300]="selectedDate() !== date">
          {{ getShortDate(date).split(' ')[1] }}
        </span>
      </button>
      }

      <!-- "Load More" Button -->
      @if (!hasLoadedExtendedRange()) {
      <button (click)="loadMoreDates()"
        class="flex-shrink-0 px-6 h-[68px] rounded-2xl glass-dark border border-dashed border-white/20 transition-all duration-300 flex flex-col items-center justify-center gap-1 hover:border-neon-cyan/50 hover:bg-neon-cyan/5 text-gray-500 hover:text-neon-cyan">
        <span class="text-[10px] uppercase font-bold tracking-widest">More</span>
        <fa-icon [icon]="faBolt" class="text-xs"></fa-icon>
      </button>
      }


      <!-- Skeletons while loading -->
      @if (isLoadingExtended()) {
      @for (i of [1,2,3,4,5]; track i) {
      <div class="flex-shrink-0 min-w-[80px] h-[68px] rounded-2xl border border-white/5 skeleton"></div>
      }
      }
    </div>
  </div>


  <!-- The Matrix -->
  @if (selectedDate()) {
  <div class="glass-dark rounded-3xl border border-white/5 overflow-hidden">
    <div class="p-4 border-b border-white/5 bg-white/5 flex items-center">
      <h3 class="w-20 text-gray-400 text-[10px] uppercase tracking-widest font-bold">Time</h3>
      <div class="flex-1 grid grid-cols-3 gap-2">
        <h3 class="text-gray-500 text-[9px] uppercase tracking-tighter font-bold text-center">Court 1</h3>
        <h3 class="text-gray-500 text-[9px] uppercase tracking-tighter font-bold text-center">Court 2</h3>
        <h3 class="text-gray-500 text-[9px] uppercase tracking-tighter font-bold text-center">Court 3</h3>
      </div>
    </div>

    <div class="divide-y divide-white/5">
      @for (row of timeSlots(); track row.time) {
      <div class="flex items-center p-4 hover:bg-white/[0.02] transition-colors group">
        <div class="w-20 flex-shrink-0">
          <span class="text-lg font-mono font-bold text-gray-400 group-hover:text-neon-cyan transition-colors">
            {{ row.time.slice(0, 2) }}:{{ row.time.slice(2) }}
          </span>
        </div>
        <div class="flex-1 grid grid-cols-3 gap-2">
          @for (slot of row.courts; track $index) {
          @if (slot) {
          <a [href]="getBookingUrl(slot)" target="_blank"
            class="relative h-10 rounded-xl text-[10px] font-bold tracking-wider transition-all duration-300 flex items-center justify-center gap-1 border border-white/10 hover:scale-105 active:scale-95 overflow-hidden"
            [class.glass]="!slot.isGolden" [class.bg-neon-cyan/10]="slot.isGolden && !slot.isJackpot"
            [class.border-neon-cyan/40]="slot.isGolden && !slot.isJackpot"
            [class.text-neon-cyan]="slot.isGolden && !slot.isJackpot" [class.bg-solar-gold/10]="slot.isJackpot"
            [class.border-solar-gold/40]="slot.isJackpot" [class.text-solar-gold]="slot.isJackpot"
            [class.text-gray-300]="!slot.isGolden">
            @if (slot.isJackpot) {
            <fa-icon [icon]="faFire" class="text-[9px] animate-pulse"></fa-icon>
            }
            <span class="hidden sm:inline">Book</span>
            <span class="sm:hidden">C{{ $index + 1 }}</span>
          </a>
          } @else {
          <div class="h-10 rounded-xl border border-dashed border-white/5 bg-black/10"></div>
          }
          }
        </div>
      </div>
      } @empty {
      <div class="p-12 text-center text-gray-500">
        <p>No slots available for this day. Try another!</p>
      </div>
      }
    </div>
  </div>
  }
</div>
}